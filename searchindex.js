Search.setIndex({"docnames": ["index", "snapshot", "utilities"], "filenames": ["index.rst", "snapshot.rst", "utilities.rst"], "titles": ["Welcome to the TorchSnapshot documentation!", "Snapshot", "Utilities"], "terms": {"i": [0, 1, 2], "pytorch": [0, 1], "librari": 0, "ad": 0, "fault": 0, "toler": 0, "larg": 0, "scale": 0, "distribut": 0, "train": [0, 2], "workload": 0, "instal": 0, "instruct": 0, "snapshot": [0, 2], "describ": 0, "applic": 0, "state": [0, 2], "take": [0, 2], "restor": [0, 2], "from": [0, 2], "elast": 0, "reproduc": 0, "asynchron": 0, "refer": 0, "util": 0, "statedict": [0, 1], "rngstate": 0, "simpl": 0, "us": [0, 1], "distributeddataparallel": 0, "ddp": 0, "torchrec": 0, "core": 1, "torchsnapshot": 1, "The": 1, "class": [1, 2], "repres": 1, "persist": 1, "storag": 1, "A": [1, 2], "user": 1, "can": [1, 2], "an": [1, 2], "via": 1, "k": 1, "save": 1, "checkpoint": 1, "load": [1, 2], "befor": 1, "need": 1, "thi": [1, 2], "done": 1, "creat": 1, "dictionari": 1, "contain": 1, "all": 1, "object": [1, 2], "wish": 1, "captur": [1, 2], "app_stat": [1, 2], "model": [1, 2], "optim": 1, "ani": [1, 2], "expos": 1, "state_dict": [1, 2], "load_state_dict": [1, 2], "ar": 1, "consid": 1, "common": 1, "modul": 1, "lr": 1, "schedul": 1, "qualifi": 1, "directli": 1, "don": 1, "t": [1, 2], "meet": 1, "requir": 1, "import": 1, "extra_st": 1, "iter": 1, "0": [1, 2], "onc": 1, "specifi": 1, "path": 1, "return": 1, "which": 1, "my": 1, "option": 1, "prepend": 1, "uri": 1, "prefix": 1, "By": 1, "default": 1, "f": 1, "suggest": 1, "file": 1, "system": 1, "locat": 1, "also": 1, "provid": 1, "perform": 1, "reliabl": 1, "integr": 1, "commonli": 1, "cloud": 1, "backend": [1, 2], "select": 1, "correspond": 1, "e": [1, 2], "g": 1, "s3": 1, "googl": 1, "bucket": 1, "do": [1, 2], "move": 1, "gpu": 1, "tensor": [1, 2], "cpu": 1, "them": 1, "implement": [1, 2], "variou": 1, "increas": 1, "throughput": 1, "decreas": 1, "host": 1, "memori": 1, "usag": 1, "transfer": 1, "manual": 1, "lower": 1, "chanc": 1, "out": 1, "issu": 1, "To": 1, "first": 1, "obtain": 1, "As": 1, "seen": 1, "previous": 1, "process": 1, "where": 1, "taken": 1, "In": 1, "anoth": 1, "more": 1, "resumpt": 1, "invok": 1, "place": 1, "avoid": 1, "unneccessari": 1, "intermedi": 1, "copi": 1, "todo": [1, 2], "str": [1, 2], "pg": 1, "processgroup": 1, "none": [1, 2], "program": 1, "one": 1, "point": 1, "time": 1, "basic": 1, "defin": 1, "At": 1, "appropri": 1, "On": 1, "resum": 1, "overview": 1, "high": 1, "level": 1, "each": 1, "valu": 1, "dict": [1, 2], "It": [1, 2], "manifest": 1, "structur": 1, "origin": 1, "compar": 1, "torch": [1, 2], "enabl": 1, "effici": 1, "random": 1, "access": 1, "weight": 1, "acceler": 1, "parallel": 1, "write": 1, "For": 1, "replic": 1, "across": 1, "rank": 1, "flexibl": 1, "yet": 1, "robust": 1, "chang": 1, "world": 1, "size": 1, "correctli": 1, "make": 1, "avail": [1, 2], "newli": 1, "join": 1, "have": 1, "runtim": 1, "purpos": 1, "fall": 1, "categori": 1, "per": 1, "shard": 1, "non": 1, "treat": 1, "onli": 1, "own": 1, "made": 1, "same": [1, 2], "glob": 1, "pattern": 1, "includ": 1, "specif": 1, "type": [1, 2], "alwai": 1, "shardedtensor": 1, "read": 1, "reshard": 1, "power": 1, "dist": 1, "If": 1, "within": 1, "either": 1, "automat": 1, "abl": 1, "cannot": 1, "unless": 1, "explicitli": 1, "coerc": 1, "classmethod": 1, "async_tak": 1, "list": 1, "_custom_tensor_prepare_func": 1, "callabl": 1, "bool": 1, "pendingsnapshot": 1, "method": 1, "consist": 1, "app": [1, 2], "after": [1, 2], "effect": 1, "result": 1, "o": 1, "background": 1, "paramet": 1, "group": 1, "unspecifi": 1, "when": [1, 2], "initi": 1, "global": 1, "singl": 1, "assum": 1, "hint": 1, "match": 1, "note": 1, "ignor": 1, "handl": 1, "wait": 1, "commit": 1, "regardless": 1, "whether": 1, "get_manifest": 1, "entri": 1, "": 1, "properti": 1, "metadata": 1, "snapshotmetadata": 1, "read_object": 1, "obj_out": 1, "memory_budget_byt": 1, "int": 1, "content": 1, "its": 1, "follow": 1, "format": 1, "stateful_nam": 1, "state_dict_kei": 1, "nested_container_kei": 1, "matter": 1, "arbitrari": 1, "must": 1, "suppli": 1, "popul": 1, "data": 1, "accord": 1, "spec": 1, "support": 1, "buffer": 1, "oper": 1, "keep": 1, "temporari": 1, "below": 1, "threshold": 1, "kwarg": 2, "protocol": 2, "handi": 2, "alreadi": 2, "primit": 2, "progress": 2, "current_epoch": 2, "last": 2, "while": 2, "num_epoch": 2, "epoch": 2, "1": 2, "foo": 2, "bar": 2, "guarante": 2, "rng": 2, "rng_state": 2, "after_tak": 2, "rand": 2, "after_restor": 2, "test": 2, "assert_clos": 2, "augment": 2, "other": 2, "than": 2, "get_rng_stat": 2}, "objects": {"torchsnapshot": [[2, 0, 1, "", "RNGState"], [1, 0, 1, "", "Snapshot"], [2, 0, 1, "", "StateDict"]], "torchsnapshot.RNGState": [[2, 1, 1, "", "load_state_dict"], [2, 1, 1, "", "state_dict"]], "torchsnapshot.Snapshot": [[1, 1, 1, "", "async_take"], [1, 1, 1, "", "get_manifest"], [1, 2, 1, "", "metadata"], [1, 1, 1, "", "read_object"], [1, 1, 1, "", "restore"], [1, 1, 1, "", "take"]], "torchsnapshot.StateDict": [[2, 1, 1, "", "load_state_dict"], [2, 1, 1, "", "state_dict"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"]}, "titleterms": {"welcom": 0, "torchsnapshot": 0, "document": 0, "api": [0, 1], "content": 0, "exampl": 0, "snapshot": 1, "describ": 1, "applic": 1, "state": 1, "take": 1, "restor": 1, "from": 1, "distribut": 1, "elast": 1, "reproduc": 1, "asynchron": 1, "refer": 1, "util": 2, "statedict": 2, "rngstate": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Welcome to the TorchSnapshot documentation!": [[0, "welcome-to-the-torchsnapshot-documentation"]], "TorchSnapshot API": [[0, "torchsnapshot-api"]], "Contents:": [[0, null]], "Examples": [[0, "examples"]], "Snapshot": [[1, "snapshot"]], "Describing the application state": [[1, "describing-the-application-state"]], "Taking a snapshot": [[1, "taking-a-snapshot"]], "Restoring from a snapshot": [[1, "restoring-from-a-snapshot"]], "Distributed snapshot": [[1, "distributed-snapshot"]], "Elasticity": [[1, "elasticity"]], "Reproducibility": [[1, "reproducibility"]], "Taking a snapshot asynchronously": [[1, "taking-a-snapshot-asynchronously"]], "API Reference": [[1, "api-reference"]], "Utilities": [[2, "utilities"]], "StateDict": [[2, "statedict"]], "RNGState": [[2, "rngstate"]]}, "indexentries": {"snapshot (class in torchsnapshot)": [[1, "torchsnapshot.Snapshot"]], "async_take() (snapshot class method)": [[1, "torchsnapshot.Snapshot.async_take"]], "get_manifest() (snapshot method)": [[1, "torchsnapshot.Snapshot.get_manifest"]], "metadata (snapshot property)": [[1, "torchsnapshot.Snapshot.metadata"]], "read_object() (snapshot method)": [[1, "torchsnapshot.Snapshot.read_object"]], "restore() (snapshot method)": [[1, "torchsnapshot.Snapshot.restore"]], "take() (snapshot class method)": [[1, "torchsnapshot.Snapshot.take"]], "rngstate (class in torchsnapshot)": [[2, "torchsnapshot.RNGState"]], "statedict (class in torchsnapshot)": [[2, "torchsnapshot.StateDict"]], "load_state_dict() (rngstate method)": [[2, "torchsnapshot.RNGState.load_state_dict"]], "load_state_dict() (statedict method)": [[2, "torchsnapshot.StateDict.load_state_dict"]], "state_dict() (rngstate method)": [[2, "torchsnapshot.RNGState.state_dict"]], "state_dict() (statedict method)": [[2, "torchsnapshot.StateDict.state_dict"]]}})