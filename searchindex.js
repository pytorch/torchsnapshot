Search.setIndex({"docnames": ["api_reference", "getting_started", "index", "utilities"], "filenames": ["api_reference.rst", "getting_started.rst", "index.rst", "utilities.rst"], "titles": ["API Reference", "Getting Started", "Welcome to the TorchSnapshot documentation!", "Utilities"], "terms": {"class": [0, 1, 3], "snapshot": [0, 2, 3], "path": [0, 1], "str": [0, 3], "pg": 0, "option": 0, "processgroup": 0, "none": [0, 3], "repres": [0, 1], "persist": [0, 1], "program": 0, "state": [0, 2, 3], "one": [0, 1], "point": 0, "time": [0, 1], "basic": 0, "usag": [0, 1], "defin": 0, "app_stat": [0, 1, 3], "model": [0, 1, 3], "optim": [0, 1], "At": 0, "an": [0, 1, 3], "appropri": 0, "take": [0, 2, 3], "On": 0, "resum": [0, 1], "restor": [0, 2, 3], "from": [0, 2, 3], "overview": 0, "high": 0, "level": 0, "torchsnapshot": [0, 1], "save": [0, 1], "each": 0, "valu": [0, 1], "dict": [0, 1, 3], "file": [0, 1], "object": [0, 1, 3], "correspond": 0, "storag": [0, 1], "system": [0, 1], "It": [0, 3], "also": 0, "manifest": 0, "describ": [0, 2], "structur": 0, "origin": 0, "compar": 0, "torch": [0, 1, 3], "load": [0, 1, 3], "enabl": 0, "effici": [0, 1], "random": 0, "access": [0, 2], "weight": [0, 1], "acceler": 0, "parallel": [0, 1], "write": [0, 1], "For": 0, "replic": [0, 1], "i": [0, 1, 2, 3], "across": [0, 1], "rank": [0, 1], "flexibl": 0, "yet": 0, "robust": 0, "elast": [0, 2], "chang": [0, 1], "world": [0, 1], "size": [0, 1], "implement": [0, 1, 3], "via": [0, 1], "correctli": [0, 1], "make": 0, "avail": [0, 1, 3], "newli": [0, 1], "join": [0, 1], "have": [0, 1], "runtim": 0, "purpos": 0, "all": [0, 1], "fall": 0, "categori": 0, "per": 0, "shard": [0, 1], "By": [0, 1], "default": [0, 1], "non": [0, 1], "ar": [0, 1], "treat": [0, 1], "onli": [0, 1], "own": 0, "made": [0, 1], "same": [0, 1, 3], "A": [0, 1, 3], "user": [0, 1], "can": [0, 1, 3], "suggest": [0, 1], "ani": [0, 1, 3], "glob": 0, "pattern": 0, "onc": [0, 1], "includ": 0, "specif": 0, "type": [0, 3], "alwai": 0, "e": [0, 1, 3], "g": [0, 1], "shardedtensor": [0, 1], "read": 0, "reshard": [0, 1], "power": 0, "dist": 0, "checkpoint": [0, 1], "If": [0, 1], "within": [0, 1], "either": 0, "automat": [0, 1], "abl": 0, "contain": [0, 1], "cannot": 0, "unless": 0, "explicitli": 0, "coerc": 0, "classmethod": 0, "async_tak": [0, 1], "t": [0, 1, 3], "list": 0, "_custom_tensor_prepare_func": 0, "callabl": 0, "tensor": [0, 1, 3], "bool": 0, "pendingsnapshot": 0, "asynchron": [0, 2], "thi": [0, 1, 3], "method": 0, "creat": [0, 1], "consist": [0, 1], "app": [0, 3], "after": [0, 1, 3], "return": [0, 1], "effect": 0, "The": [0, 1], "result": [0, 1], "perform": [0, 1], "o": [0, 1], "background": [0, 1], "paramet": 0, "locat": [0, 1], "process": [0, 1], "group": 0, "unspecifi": 0, "when": [0, 1, 3], "distribut": [0, 2], "initi": 0, "global": [0, 1], "us": [0, 1, 2], "singl": [0, 1], "assum": 0, "hint": 0, "match": 0, "note": 0, "specifi": [0, 1], "ignor": 0, "handl": 0, "which": [0, 1], "taken": [0, 1], "obtain": [0, 1], "wait": [0, 1], "commit": 0, "regardless": 0, "whether": 0, "invok": [0, 1], "get_manifest": [0, 1], "entri": 0, "": [0, 1], "properti": 0, "metadata": 0, "snapshotmetadata": 0, "read_object": [0, 1], "obj_out": 0, "memory_budget_byt": 0, "int": 0, "content": 0, "its": 0, "follow": 0, "format": 0, "stateful_nam": 0, "state_dict_kei": 0, "nested_container_kei": 0, "matter": 0, "arbitrari": 0, "must": 0, "suppli": 0, "popul": 0, "data": [0, 1], "accord": 0, "spec": 0, "support": [0, 1], "place": [0, 1], "directli": [0, 1], "buffer": 0, "oper": 0, "keep": 0, "temporari": 0, "memori": [0, 1], "below": 0, "threshold": 0, "core": 1, "api": 1, "k": 1, "befor": 1, "need": 1, "done": 1, "dictionari": 1, "wish": 1, "captur": [1, 3], "expos": 1, "state_dict": [1, 3], "load_state_dict": [1, 3], "consid": 1, "common": 1, "pytorch": [1, 2], "modul": 1, "lr": 1, "schedul": 1, "qualifi": 1, "don": 1, "meet": 1, "requir": 1, "statedict": [1, 2], "import": 1, "extra_st": 1, "iter": 1, "0": [1, 3], "refer": [1, 2], "provid": 1, "reliabl": 1, "integr": 1, "commonli": 1, "cloud": 1, "out": 1, "box": 1, "select": 1, "differ": 1, "backend": [1, 3], "prepend": 1, "uri": 1, "prefix": 1, "s3": 1, "googl": 1, "f": 1, "local": 1, "network": 1, "my": 1, "altern": 1, "bucket": 1, "do": [1, 3], "move": 1, "gpu": 1, "cpu": 1, "them": 1, "variou": 1, "increas": 1, "throughput": 1, "decreas": 1, "host": 1, "transfer": 1, "manual": 1, "lower": 1, "chanc": 1, "issu": 1, "To": 1, "first": 1, "As": 1, "seen": 1, "previous": 1, "where": 1, "In": 1, "anoth": 1, "more": 1, "resumpt": 1, "whenev": 1, "possibl": 1, "avoid": 1, "unneccessari": 1, "intermedi": 1, "copi": 1, "citizen": 1, "simpli": 1, "simultan": 1, "similar": 1, "call": 1, "organ": 1, "drastic": 1, "improv": 1, "workload": [1, 2], "evenli": 1, "benchmark": 1, "speedup": 1, "better": 1, "unit": 1, "util": [1, 2], "ddp_model": 1, "distributeddataparallel": [1, 2], "without": 1, "fetch": 1, "entir": 1, "even": 1, "store": 1, "learn": 1, "post": 1, "too": 1, "larg": [1, 2], "fit": 1, "devic": 1, "queri": 1, "layer_0_weight": 1, "layer_0": 1, "abund": 1, "leverag": 1, "allow": 1, "train": [1, 2, 3], "complet": 1, "soon": 1, "stage": 1, "ram": 1, "reduc": 1, "block": 1, "especi": 1, "underli": 1, "slow": 1, "pending_snapshot": 1, "pend": 1, "statu": 1, "despit": 1, "async": 1, "name": 1, "determinist": 1, "rngstate": [1, 2], "help": 1, "manag": 1, "ensur": 1, "rng": [1, 3], "set": 1, "rng_state": [1, 3], "x": 1, "long": 1, "1": [1, 3], "exist": 1, "under": 1, "kei": 1, "2": 1, "hold": 1, "dure": 1, "exampl": 1, "whose": 1, "multipl": 1, "current": 1, "part": 1, "due": 1, "neither": 1, "prevent": 1, "accident": 1, "librari": 2, "ad": 2, "fault": 2, "toler": 2, "scale": 2, "instal": 2, "instruct": 2, "get": 2, "start": 2, "applic": 2, "reproduc": 2, "experiment": 2, "simpl": 2, "ddp": 2, "torchrec": 2, "kwarg": 3, "protocol": 3, "handi": 3, "alreadi": 3, "primit": 3, "progress": 3, "current_epoch": 3, "last": 3, "while": 3, "num_epoch": 3, "epoch": 3, "foo": 3, "bar": 3, "guarante": 3, "after_tak": 3, "rand": 3, "after_restor": 3, "test": 3, "assert_clos": 3, "todo": 3, "augment": 3, "other": 3, "than": 3, "get_rng_stat": 3}, "objects": {"torchsnapshot": [[3, 0, 1, "", "RNGState"], [0, 0, 1, "", "Snapshot"], [3, 0, 1, "", "StateDict"]], "torchsnapshot.RNGState": [[3, 1, 1, "", "load_state_dict"], [3, 1, 1, "", "state_dict"]], "torchsnapshot.Snapshot": [[0, 1, 1, "", "async_take"], [0, 1, 1, "", "get_manifest"], [0, 2, 1, "", "metadata"], [0, 1, 1, "", "read_object"], [0, 1, 1, "", "restore"], [0, 1, 1, "", "take"]], "torchsnapshot.StateDict": [[3, 1, 1, "", "load_state_dict"], [3, 1, 1, "", "state_dict"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"]}, "titleterms": {"api": [0, 2], "refer": 0, "get": 1, "start": 1, "describ": 1, "applic": 1, "state": 1, "take": 1, "snapshot": 1, "restor": 1, "from": 1, "distribut": 1, "content": [1, 2], "access": 1, "asynchron": 1, "reproduc": 1, "elast": 1, "experiment": 1, "welcom": 2, "torchsnapshot": 2, "document": 2, "exampl": 2, "util": 3, "statedict": 3, "rngstate": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"]], "Getting Started": [[1, "getting-started"]], "Describing the Application State": [[1, "describing-the-application-state"]], "Taking a Snapshot": [[1, "taking-a-snapshot"]], "Restoring From a Snapshot": [[1, "restoring-from-a-snapshot"]], "Distributed Snapshot": [[1, "distributed-snapshot"]], "Snapshot Content Access": [[1, "snapshot-content-access"]], "Taking a Snapshot Asynchronously": [[1, "taking-a-snapshot-asynchronously"]], "Reproducibility": [[1, "reproducibility"]], "Elasticity (Experimental)": [[1, "elasticity-experimental"]], "Welcome to the TorchSnapshot documentation!": [[2, "welcome-to-the-torchsnapshot-documentation"]], "TorchSnapshot API": [[2, "torchsnapshot-api"]], "Contents:": [[2, null]], "Examples": [[2, "examples"]], "Utilities": [[3, "utilities"]], "StateDict": [[3, "statedict"]], "RNGState": [[3, "rngstate"]]}, "indexentries": {"snapshot (class in torchsnapshot)": [[0, "torchsnapshot.Snapshot"]], "async_take() (snapshot class method)": [[0, "torchsnapshot.Snapshot.async_take"]], "get_manifest() (snapshot method)": [[0, "torchsnapshot.Snapshot.get_manifest"]], "metadata (snapshot property)": [[0, "torchsnapshot.Snapshot.metadata"]], "read_object() (snapshot method)": [[0, "torchsnapshot.Snapshot.read_object"]], "restore() (snapshot method)": [[0, "torchsnapshot.Snapshot.restore"]], "take() (snapshot class method)": [[0, "torchsnapshot.Snapshot.take"]], "rngstate (class in torchsnapshot)": [[3, "torchsnapshot.RNGState"]], "statedict (class in torchsnapshot)": [[3, "torchsnapshot.StateDict"]], "load_state_dict() (rngstate method)": [[3, "torchsnapshot.RNGState.load_state_dict"]], "load_state_dict() (statedict method)": [[3, "torchsnapshot.StateDict.load_state_dict"]], "state_dict() (rngstate method)": [[3, "torchsnapshot.RNGState.state_dict"]], "state_dict() (statedict method)": [[3, "torchsnapshot.StateDict.state_dict"]]}})